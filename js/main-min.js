"use strict";var Aria2=void 0===window.Aria2?require("aria2"):window.Aria2,data={host:"localhost",port:6800,secure:!1,secret:"",path:"/jsonrpc"},aria2=new Aria2(data);aria2.onopen=function(){console.log("aria2 open")},aria2.open();var store=new Vuex.Store({state:{currentTab:"All"},mutations:{setCurrentTab:function t(e,i){e.currentTab=i}}});Vue.component("task",{template:"#task-template",props:["data"],computed:{percentFinished:function t(){var e=(this.data.completedLength/this.data.totalLength*100).toFixed(2);return e=parseFloat(e),e!=e?0:e},finishedSize:function t(){return this.convertToFileSize(this.data.completedLength)},totalSize:function t(){return this.convertToFileSize(this.data.totalLength)},downloadSpeed:function t(){return this.convertToFileSize(this.data.downloadSpeed)+"/s"},status:function t(){var e=this.data.status;return"seeding paused"===e?"Seeding Paused":e[0].toUpperCase()+e.substr(1)},timeRemaining:function t(){var e=this.data.totalLength-this.data.completedLength,i=e/this.data.downloadSpeed;return i!=i||i===1/0?1/0:this.convertToTime(math.round(i))},uploadSpeed:function t(){if(void 0!==this.data.uploadSpeed)return this.convertToFileSize(this.data.uploadSpeed)+"/s"},directory:function t(){return this.data.dir},connections:function t(){return this.data.connections},seeders:function t(){return this.data.numSeeders},isSeeding:function t(){return this.data.seeder},name:function t(){return this.data.bittorrent&&this.data.bittorrent.info?this.data.bittorrent.info.name:""===this.data.files[0].path?this.data.files[0].uris[0].uri:this.getFileNameFromPath(this.data.files[0].path)},metadata:function t(){return this.data.following}},methods:{convertToFileSize:function t(e){return e<1024?e+"B":e<1048576?parseFloat((e/1024).toFixed(2))+"KB":e<1073741824?parseFloat((e/1048576).toFixed(2))+"MB":e<1099511627776?parseFloat((e/1073741824).toFixed(2))+"GB":parseFloat((e/1099511627776).toFixed(2))+"TB"},convertToTime:function t(e){return e<60?e+"s":e<3600?math.round(e/60)+"min":e<216e3?math.round(e/3600)+"h":math.round(e/86400)+"d"},selectTask:function t(e){var i=e.currentTarget;i.classList.contains("is-selected")?i.classList.remove("is-selected"):i.classList.add("is-selected")},showInfo:function t(e){e.stopPropagation();var i=e.currentTarget,n=e.currentTarget.parentElement.nextElementSibling;n.classList.contains("is-shown")?(Velocity(i,{rotateZ:0}),n.classList.remove("is-shown")):(Velocity(i,{rotateZ:180}),n.classList.add("is-shown"))},getFileNameFromPath:function t(e){return e.replace(/^.*[\\\/]/,"")}}}),Vue.component("simple-tabs",{template:"#simple-tabs-template",methods:{selectTab:function t(e){this.$children.forEach(function(t){t.name!==e.name?t.isActive=!1:t.isActive=!0})}}}),Vue.component("simple-tab",{template:"#simple-tab-template",props:{name:{required:!0},selected:{default:!1}},data:function t(){return{isActive:!1}},mounted:function t(){this.isActive=this.selected}}),Vue.component("tabs",{template:"#tabs-template",data:function t(){return{tabs:[]}},created:function t(){this.tabs=this.$children},methods:{selectTab:function t(e){this.tabs.forEach(function(t){t.isActive=t.name===e.name}),store.commit("setCurrentTab",e.name)}}}),Vue.component("tab",{template:"#tab-template",props:{name:{required:!0},selected:{default:!1},icon:{required:!0}},data:function t(){return{isActive:!1}},mounted:function t(){this.isActive=this.selected}});var app=new Vue({el:"#app",data:{url:"",specialActive:[],waiting:[],paused:[],specialComplete:[],error:[],seeding:[],seedingPaused:[]},computed:{all:function t(){return this.active.concat(this.complete)},currentTab:function t(){return store.state.currentTab},active:function t(){return this.specialActive.concat(this.paused.concat(this.waiting.concat(this.error)))},complete:function t(){return this.specialComplete.concat(this.seeding.concat(this.seedingPaused))}},mounted:function t(){var e=this;aria2.getVersion().then(function(t){e.printString(JSON.stringify(t))},function(t){e.printString(JSON.stringify(t))}),setInterval(function(){e.updateView()},500)},methods:{openAddDialog:function t(){document.getElementById("addDialog").classList.add("is-active")},closeAddDialog:function t(){document.getElementById("addDialog").classList.remove("is-active")},addLink:function t(e){var i=this;aria2.addUri([e]).then(function(t){i.printString(JSON.stringify(t))},function(t){i.printString(JSON.stringify(t))}),i.url="",i.updateView(),i.clearSelected()},printString:function t(e){new Noty({layout:"topRight",theme:"mint",timeout:5e3,progressBar:!0,closeWith:["click"],queue:"global",text:e,force:!0,animation:{open:function t(e){var i=this;Velocity(i.barDom,{left:450,scaleY:2},{duration:0}),Velocity(i.barDom,{left:0,scaleY:1},{easing:[8,8],complete:function t(){e(function(t){t()})}})},close:function t(e){var i=this;Velocity(i.barDom,{left:"+=-50"},{easing:[8,8,2],duration:350}),Velocity(i.barDom,{left:450,scaleY:.2,height:0,margin:0},{easing:[8,8],complete:function t(){e(function(t){t()})}})}}}).show()},updateView:function t(){var e=this;setTimeout(function(){aria2.tellWaiting(0,1e3).then(function(t){for(var i=[],n=[],a=[],s=0;s<t.length;++s)"paused"===t[s].status?"true"===t[s].seeder?(t[s].status="seeding paused",a.push(t[s])):i.push(t[s]):n.push(t[s]);e.waiting=n,e.paused=i,e.seedingPaused=a},function(t){e.printString(JSON.stringify(t))}),aria2.tellActive([0,1e3]).then(function(t){for(var i=[],n=[],a=0;a<t.length;++a)"true"===t[a].seeder?(t[a].status="seeding",n.push(t[a])):i.push(t[a]);e.specialActive=i,e.seeding=n},function(t){e.printString(JSON.stringify(t))}),aria2.tellStopped(0,1e3).then(function(t){for(var i=[],n=[],a=0;a<t.length;++a)"complete"===t[a].status?t[a].followedBy||i.push(t[a]):n.push(t[a]);e.specialComplete=i,e.error=n},function(t){e.printString(JSON.stringify(t))})},100)},deleteTasks:function t(){for(var e=this,i=document.getElementsByClassName("task"),n=0;n<i.length;++n)if(i[n].classList.contains("is-selected")){var a=e.all[n].status;"active"===a||"waiting"===a||"paused"===a?e.deleteActiveTask(n):e.deleteCompletedTask(n)}e.updateView(),e.clearSelected()},clearSelected:function t(){for(var e=document.getElementsByClassName("is-selected");0!=e.length;)e[0].classList.remove("is-selected")},deleteActiveTask:function t(e){var i=this;aria2.remove(i.all[e].gid).then(function(t){i.printString("Successfully deleted "+JSON.stringify(t))},function(t){i.printString(JSON.stringify(t))}),i.deleteCompletedTask(e)},deleteCompletedTask:function t(e){var i=this;aria2.removeDownloadResult(i.all[e].gid).then(function(t){i.printString("Successfully deleted "+JSON.stringify(t))},function(t){i.printString(JSON.stringify(t))})},pauseTasks:function t(){for(var e=this,i=document.getElementsByClassName("task"),n=0;n<i.length;++n)i[n].classList.contains("is-selected")&&aria2.pause(e.all[n].gid).then(function(t){e.printString("Successfully paused "+JSON.stringify(t))},function(t){e.printString(JSON.stringify(t))});e.updateView(),e.clearSelected()},pauseAllTasks:function t(){var e=this;aria2.pauseAll().then(function(t){e.printString("Paused all "+JSON.stringify(t))},function(t){e.printString(JSON.stringify(t))}),e.clearSelected(),setTimeout(function(){e.updateView()},1e3)},resumeTasks:function t(){for(var e=this,i=document.getElementsByClassName("task"),n=0;n<i.length;++n)if(i[n].classList.contains("is-selected"))if("error"===e.all[n].status){var a=e.all[n].files[0].uris[0].uri;this.deleteCompletedTask(n),this.addLink(a)}else aria2.unpause(e.all[n].gid).then(function(t){e.printString("Successfully resumed "+JSON.stringify(t))},function(t){e.printString(JSON.stringify(t))});e.updateView(),e.clearSelected()},resumeAllTasks:function t(){var e=this;aria2.unpauseAll().then(function(t){e.printString("Resumed all "+JSON.stringify(t))},function(t){e.printString(JSON.stringify(t))}),e.updateView(),e.clearSelected()},fileChange:function t(e){for(var i=this,n=e.target.files,a=function t(e){var a=new FileReader;a.onload=function(){var t=window.btoa(a.result);console.log(t),aria2.addTorrent(t).then(function(t){i.printString("Added Torrent "+JSON.stringify(t))},function(t){i.printString(JSON.stringify(t))}),i.updateView()},a.readAsBinaryString(n[e])},s=0;s<n.length;++s)a(s)}}});