"use strict";var Aria2=window.Aria2,data={host:"localhost",port:6800,secure:!1,secret:"",path:"/jsonrpc"},aria2=new Aria2(data),store=new Vuex.Store({state:{currentTab:"All"},mutations:{setCurrentTab:function t(e,i){e.currentTab=i}}});Vue.component("task",{template:"#task-template",props:["data"],computed:{percentFinished:function t(){var e=(this.data.completedLength/this.data.totalLength*100).toFixed(2);return e=parseFloat(e),e!=e?0:e},finishedSize:function t(){return this.convertToFileSize(this.data.completedLength)},totalSize:function t(){return this.convertToFileSize(this.data.totalLength)},downloadSpeed:function t(){return this.convertToFileSize(this.data.downloadSpeed)+"/s"},status:function t(){return this.data.status[0].toUpperCase()+this.data.status.substr(1)},timeRemaining:function t(){var e=this.data.totalLength-this.data.completedLength,i=e/this.data.downloadSpeed;return i!=i||i===1/0?1/0:this.convertToTime(math.round(i))}},methods:{convertToFileSize:function t(e){return e<1024?e+"B":e<1048576?parseFloat((e/1024).toFixed(2))+"KB":e<1073741824?parseFloat((e/1048576).toFixed(2))+"MB":e<1099511627776?parseFloat((e/1073741824).toFixed(2))+"GB":parseFloat((e/1099511627776).toFixed(2))+"TB"},convertToTime:function t(e){return e<60?e+"s":e<3600?math.round(e/60)+"min":e<216e3?math.round(e/3600)+"h":math.round(e/86400)+"d"}}}),Vue.component("tabs",{template:"#tabs-template",data:function t(){return{tabs:[]}},created:function t(){this.tabs=this.$children},methods:{selectTab:function t(e){this.tabs.forEach(function(t){t.isActive=t.name===e.name}),store.commit("setCurrentTab",e.name)}}}),Vue.component("tab",{template:"#tab-template",props:{name:{required:!0},selected:{default:!1},icon:{}},data:function t(){return{isActive:!1}},mounted:function t(){this.isActive=this.selected}});var app=new Vue({el:"#app",data:{message:"",url:"",active:[],waiting:[],paused:[],stopped:[],complete:[],error:[]},computed:{all:function t(){return this.active.concat(this.waiting.concat(this.paused.concat(this.complete.concat(this.error))))},currentTab:function t(){return store.state.currentTab}},mounted:function t(){var e=this;aria2.getVersion().then(function(t){e.printString(JSON.stringify(t))},function(t){e.printString(JSON.stringify(t))}),setInterval(function(){e.updateView()},500)},methods:{openAddDialog:function t(){document.getElementById("addDialog").classList.add("is-active")},closeAddDialog:function t(){document.getElementById("addDialog").classList.remove("is-active")},addLink:function t(e){var i=this;aria2.addUri([e]).then(function(t){i.printString(JSON.stringify(t))},function(t){i.printString(JSON.stringify(t))}),i.url="",i.updateView(),i.clearSelected()},printString:function t(e){this.message+="<br>"+e},updateView:function t(){var e=this;setTimeout(function(){aria2.tellWaiting(0,1e3).then(function(t){e.appendFileName(t);for(var i=[],n=[],a=0;a<t.length;++a)"paused"===t[a].status?i.push(t[a]):n.push(t[a]);e.waiting=n,e.paused=i},function(t){e.printString(JSON.stringify(t))}),aria2.tellActive([0,1e3]).then(function(t){e.active=t,e.appendFileName(e.active)},function(t){e.printString(JSON.stringify(t))}),aria2.tellStopped(0,1e3).then(function(t){e.appendFileName(t);for(var i=[],n=[],a=0;a<t.length;++a)"complete"===t[a].status?i.push(t[a]):n.push(t[a]);e.complete=i,e.error=n},function(t){e.printString(JSON.stringify(t))})},100)},selectTask:function t(e){var i=e.currentTarget;i.classList.contains("is-selected")?i.classList.remove("is-selected"):i.classList.add("is-selected")},deleteTasks:function t(){for(var e=this,i=document.getElementsByClassName("task"),n=0;n<i.length;++n)if(i[n].classList.contains("is-selected")){var a=e.all[n].status;"active"===a||"waiting"===a||"paused"===a?e.deleteActiveTask(n):e.deleteCompletedTask(n)}e.updateView(),e.clearSelected()},clearSelected:function t(){for(var e=document.getElementsByClassName("is-selected");0!=e.length;)e[0].classList.remove("is-selected")},deleteActiveTask:function t(e){var i=this;aria2.remove(i.all[e].gid).then(function(t){i.printString("Successfully deleted "+JSON.stringify(t))},function(t){i.printString(JSON.stringify(t))}),i.deleteCompletedTask(e)},deleteCompletedTask:function t(e){var i=this;aria2.removeDownloadResult(i.all[e].gid).then(function(t){i.printString("Successfully deleted "+JSON.stringify(t))},function(t){i.printString(JSON.stringify(t))})},pauseTasks:function t(){for(var e=this,i=document.getElementsByClassName("task"),n=0;n<i.length;++n)i[n].classList.contains("is-selected")&&aria2.pause(e.all[n].gid).then(function(t){e.printString("Successfully paused "+JSON.stringify(t))},function(t){e.printString(JSON.stringify(t))});e.updateView(),e.clearSelected()},pauseAllTasks:function t(){var e=this;aria2.pauseAll().then(function(t){e.printString("Paused all "+JSON.stringify(t))},function(t){e.printString(JSON.stringify(t))}),e.clearSelected(),setTimeout(function(){e.updateView()},1e3)},resumeTasks:function t(){for(var e=this,i=document.getElementsByClassName("task"),n=0;n<i.length;++n)i[n].classList.contains("is-selected")&&aria2.unpause(e.all[n].gid).then(function(t){e.printString("Successfully resumed "+JSON.stringify(t))},function(t){e.printString(JSON.stringify(t))});e.updateView(),e.clearSelected()},resumeAllTasks:function t(){var e=this;aria2.unpauseAll().then(function(t){e.printString("Resumed all "+JSON.stringify(t))},function(t){e.printString(JSON.stringify(t))}),e.updateView(),e.clearSelected()},appendFileName:function t(e){for(var i=0;i<e.length;++i)""===e[i].files[0].path?e[i].taskName=e[i].files[0].uris[0].uri:e[i].taskName=this.getFileNameFromPath(e[i].files[0].path)},getFileNameFromPath:function t(e){return e.replace(/^.*[\\\/]/,"")}}});